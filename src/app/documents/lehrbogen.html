<cb-header>Lehrbogen</cb-header>

<h2 class="no-space">Wie du mit diesen Lehrbogen arbeitest</h2>
<p>
  Du findest in den folgenden Kapiteln immer wieder Kästen, die speziell markiert sind, zum Beispiel:
</p>
<div class="cb-text-box">
  <cb-badge badge="minecraft"></cb-badge>
  <p>
    Diesen Kasten solltest du lesen, wenn du nicht mit Minecraft vertraut bist. Wenn du dich mit Minecraft gut auskennst, kannst du ihn auch überspringen.
  </p>
</div>
<p>
  Genauso gibt es Kästen mit "Java", die du lesen solltest, wenn du die Programmiersprache Java noch nicht kennst. So kannst du auswählen, welche Informationen für dich neu sind, und was du bereits weißt.
</p>
<p>
  Außerdem findest du immer wieder mal:
</p>
<div class="cb-text-box black">
  <b>Übungsaufgaben</b>
  <p>
    Diese kannst du bearbeiten, um das Erlernte zu festigen und dich zu testen.
  </p>
  <cb-collapsable label="Lösungen">
    <p>
      Hier siehst du dann die Lösungen.
    </p>
  </cb-collapsable>
</div>
<p>
  Viel Spaß!
</p>


<cb-chapter ordinal="1">Vorbereitung</cb-chapter>

<div class="cb-text-box">
  <p>
    Für <b>Bundle-Nutzer</b>:
  </p>
  <p>
    Befolge die Schritte 1, 2 (nur 1.) und 4 (1.-2.) in <a routerLink="/bundle-einfuehrung-und-benutzungsanweisung">Cranberri Bundle: Einführung & Benutzungsanweisung</a>, um ein Projekt zu erstellen und VS Code zu öffnen.
  </p>
</div>

<p>
  Erstelle ein neues Projekt, benenne es "programm1" und öffne es in VS Code.
  Auf der linken Seite <cb-img-dot>1</cb-img-dot> findest du die Dateien, die dein Projekt umfasst.
  <cb-code>project.yaml</cb-code> und alles in <cb-code>lib</cb-code> ist für dich vorerst uninteressant.
</p>

<p>
  Doppelklicke auf <cb-code>scripts</cb-code> -> <cb-code>script.java</cb-code> <span class="cb-space"></span> <cb-img-dot>2</cb-img-dot>.
  Im Hauptfenster öffnet sich jetzt dein Programm.
  Alles unter <cb-code>void setup() {{"{"}} ... }</cb-code> <span class="cb-space"></span> <cb-img-dot>3</cb-img-dot> wird zum Programmstart ausgeführt,
  alles unter <cb-code>void tick() {{"{"}} ... }</cb-code> <span class="cb-space"></span> <cb-img-dot>4</cb-img-dot> wird immer wieder ausgefährt, nämlich zu jedem Spieltick, also 20 mal pro Sekunde.
</p>

<img src="assets/documents/lehrbogen/abb-projekt-in-vs-code.png">

<p>
  Lösche zunächst das vorhandene Programm, sodass nur noch übrig bleibt:
</p>

<cb-code src="assets/documents/lehrbogen/listing-leeres-programm.java"></cb-code>

<p>
  <b>Fertig!</b> Du hast jetzt ein leeres Projekt, mit dem du arbeiten kannst.
</p>


<cb-chapter ordinal="2">Es werde Licht!</cb-chapter>

<h2 class="no-space">Schaltung</h2>

<div class="cb-text-box">
  <p>
    Für <b>Bundle-Nutzer</b>:
  </p>
  <p>
    Befolge die Schritte 2 (2.-3.) und 3 in <a routerLink="/bundle-einfuehrung-und-benutzungsanweisung">Cranberri Bundle: Einführung & Benutzungsanweisung</a>, um den Server mit einer neuen Welt zu starten und die Welt in Minecraft zu öffnen.
  </p>
</div>

<p>
  Starte den Server mit einer neuen Welt und öffne sie in Minecraft.
</p>

<div class="cb-text-box large">
  <cb-badge badge="minecraft"></cb-badge>
  <p>
    In Minecraft brauchst du die folgenden Tasten, um das Spiel zu steuern:
  </p>
  <ul>
    <li><cb-code color="grey">W</cb-code>, <cb-code color="grey">A</cb-code>, <cb-code color="grey">S</cb-code> und <cb-code color="grey">D</cb-code> zum vorwärts, links, rückwärts und rechts bewegen.</li>
    <li><cb-code color="grey">Leertaste</cb-code> zum Hüpfen. Doppeltippen darauf, um im Kreativmodus zu fliegen.</li>
    <li>Bewege deine Maus, um dich umzusehen.</li>
    <li>Linke Maustaste zum Zerstören, rechte Maustaste zum Platzieren von Blöcken.</li>
    <li>Bewege das Mausrad oder verwende die Tasten <cb-code color="grey">1</cb-code> bis <cb-code color="grey">9</cb-code>, um verschiedene Items in deiner Hotbar auszuwählen.</li>
    <li>Drücke <cb-code color="grey">E</cb-code>, um dein Inventar zu öffnen. Hier kannst du (im Kreativmodus) beliebige Items nehmen und in deiner Hotbar ablegen.</li>
    <li>Drücke <cb-code color="grey">T</cb-code> zum Öffnen des Chats. Hier kannst du Befehle eingeben und mit <cb-code color="grey">Enter</cb-code> ausführen.</li>
  </ul>
  <p>
    Führe den den Befehl <cb-code>/gamemode creative</cb-code> aus, um den Kreativmodus zu aktivieren. Damit bist du unverwundbar, hast Zugriff auf beliebige Items und kannst fliegen.
  </p>
</div>

<p>
  Finde im Kreativmodus eine schöne freie Fläche, auf der du arbeiten kannst. Führe dann den Befehl <cb-code>/cb</cb-code> aus, um einen Cranberri-Computer zu erhalten.
</p>
<ol>
  <li>Platziere ihn auf einem passenden Block, z. B. Grasblock.</li>
  <li>Platziere nun an der Seite des Computers eine Reihe von ca. 2 Glasblöcken in eine beliebige Richtung. Das ist die Basis für alle Pins am Computer. Pins sind die Stellen, an denen Redstone-Komponenten wie Lampen, Schalter etc. an den Computer angeschlossen werden können.</li>
  <li>Platziere an einen der Glasblöcke einen Redstone-Verstärker, der vom Glasblock wegzeigt. Das ist nun Pin 1.</li>
  <li>Setze daran einen weiteren Verstärker<cb-footnote text="Das hat einen Bug zur Ursache, durch den die Leitung sonst flackert. Bis dieser behoben ist, ist das das einfachste Workaround."></cb-footnote> und verbinde mit einem Redstone-Staub eine Redstone-Lampe.</li>
</ol>
<p>
  Die Schaltung sollte jetzt so aussehen:
</p>

<img src="assets/documents/lehrbogen/abb-versuch1-schaltung.png">
<p></p>

<div class="cb-text-box large">
  <cb-badge badge="minecraft"></cb-badge>
  <p>
    <b>Redstone</b> ist eine sehr vielseitige Spielmechanik von Minecraft, die ähnlich funktioniert wie Elektronik in der Realität. Man kann damit alles bauen von einer simplen Schaltung um eine Lampe zu steuern bis hin zu riesigen funktionierenden Computern. Für Cranberri brauchst du lediglich die Grundlagen, die mit diesem Beispiel gut erklärt sind:
  </p>
  <img src="assets/documents/lehrbogen/abb-grundlagen-redstone.png" class="small">
  <p>
    Rechts siehst du eine Redstone-Fackel <cb-img-dot>1</cb-img-dot>, die als Energiequelle dient. Hier wird der "Strom" über ein Redstone-Kabel bzw. Redstone-Staub <cb-img-dot>2</cb-img-dot> übertragen. Die Redstone-Lampe <cb-img-dot>3</cb-img-dot> wird dadurch aktiviert und leuchtet.
  </p>
  <p>
    Links ist die Fackel durch einen Schalter <cb-img-dot>4</cb-img-dot> ersetzt. Du siehst ihn im deaktivierten und im aktivierten <cb-img-dot>5</cb-img-dot> Zustand. Mit einem Rechtsklick kannst du ihn umschalten.
  </p>
  <p>
    Der Redstone-Verstärker dient normalerweise zur Verstärkung von Strom, für Cranberri wird er aber einfach als Stromquelle eingesetzt, die vom Computer gesteuert wird.
  </p>
</div>

<h2>Programm</h2>

<p>
  Jetzt geht es an das Schreiben deines ersten Programms. Gehe dazu wieder zurück in VS Code (mit <cb-code color="grey">Esc</cb-code> bekommst du deinen Mauszeiger zurück) und öffne wieder dein Programm <cb-code>script.java</cb-code>, das von 1. noch leer sein sollte.
</p>
<p>
  Das Ziel deiner ersten Schaltung ist es, die Redstone-Lampe beim Start des Computers anzuschalten. Dazu brauchst du den Befehl <cb-code>writePin(&lt;Pin&gt;, &lt;Wert&gt;)</cb-code>. Dieser setzt den angegebenen Pin auf den angegebenen Wert. Du hast deine Lampe an Pin 1 angeschlossen und willst sie anschalten, der Befehl lautet also: <cb-code>writePin(1, HIGH)</cb-code>, dabei steht "HIGH" für "an" ("LOW" wäre "aus"). Das soll einmalig beim Start des Computers passieren, also bei <cb-code>setup()</cb-code>. Da nichts immer wieder passieren soll, kannst du <cb-code>tick()</cb-code> löschen. Das fertig Programm sieht jetzt so aus:
</p>

<cb-code src="assets/documents/lehrbogen/listing-versuch1-final.java"></cb-code>

<p></p>

<div class="cb-text-box large">
  <cb-badge badge="java"></cb-badge>
  <p>
    Die Cranberri-Programme sind in der Programmiersprache Java geschrieben. Hier eine kleine Erläuterung der Grundlagen:
  </p>
  <p>
    Die Funktionsdefinitionen <cb-code>void setup() {{"{"}} ... }</cb-code> und <cb-code>void tick() {{"{"}} ... }</cb-code> sind wie Überschriften, die dein Programm in logisch zusammenhängende Abschnitte einteilen.
  </p>
  <p>
    Befehle wie <cb-code>writePin(1, HIGH);</cb-code> werden meist Zeile für Zeile untereinander geschrieben. Sie enden in Java <i>immer</i> mit einem Semikolon <cb-code>;</cb-code>!
  </p>
</div>

<p>
  Als letztes musst du das Programm nur noch auf den Cranberri-Computer übertragen und ausführen.
</p>
<ol>
  <li>Gehe dazu zurück in Minecraft und rechtsklicke den Computer-Block.</li>
  <li>Klicke auf das Buch ("Skript...") und gib im Textfeld dein Skript an nach dem Format <cb-code>&lt;Projektname&gt;:&lt;Skriptname&gt;</cb-code>, in diesem Fall also <cb-code>programm1:script</cb-code>.</li>
  <li>Klicke das Buch rechts ("Confirm"), um deine Angabe zu bestätigen und den Dialog zu schließen.</li>
  <li>Klicke nun auf die noch weißen Wolle ("Off"), um den Computer zu aktivieren und das Skript zu starten. Die Wolle ist nun grün und zeigt "On". Verlasse den Dialog (<cb-code color="grey">Esc</cb-code>).</li>
</ol>
<p>
  Nach wenigen Sekunden sollte der Computer bereit sein und starten. Im Chat ist dann "Starting" zu lesen. Der Pin leuchtet rot auf, da er aktiviert ist, und die Lampe leuchtet.
</p>

<img src="assets/documents/lehrbogen/abb-versuch1-computer-gestartet.png">

<p>
  <b>Herzlichen Glückwunsch!</b> Du hast erfolgreich dein erstes Programm und deine erste Schaltung erstellt und die Lampe zum Leuchten gebracht.
</p>

<div class="cb-text-box black">
  <h2>Übungsaufgabe</h2>
  <p>
    Schreibe den Befehl, um in einer hypothetischen Schaltung eine Lampe, die an Pin 2 angeschlossen ist, auszuschalten.
  </p>
  <cb-collapsable label="Lösung">
    <cb-code>writePin(2, LOW);</cb-code>
  </cb-collapsable>
</div>


<cb-chapter ordinal="3">Die Lampe blinkt</cb-chapter>

<h2 class="no-space">Debugging deaktivieren</h2>

<p>
  Aktuell gibt dein Programm immer, wenn es einen Pin steuert, in der Konsole aus, was es tut:
</p>
<img src="assets/documents/lehrbogen/abb-debugging.png" class="extra-small">
<p>
  Das ist sehr praktisch, wenn man genau nachprüfen möchte, was das eigene Programm macht, es kann aber auch sehr störend sein, wenn der Computer sehr oft Pins schaltet. Deaktiviere es deshalb vorerst mit dem Befehl <cb-code>disableDebug()</cb-code>. Da das einmalig beim Programmstart passieren soll, rufst du den Befehl am besten in <cb-code>setup()</cb-code> auf. Füge entsprechend den folgenden Programmcode an den Anfang deines Programms ein:
</p>
<cb-code src="assets/documents/lehrbogen/listing-disable-debug.java"></cb-code>

<h2>Tick-Zähler</h2>

<p>
  Deine nächste Aufgabe ist es, ein Programm zu schreiben, das die Lampe in Intervallen von einer halben Sekunde blinken lässt. Da das etwas ist, was nicht nur am Programmstart passieren soll, brauchst du dafür wieder <cb-code>tick()</cb-code>. <cb-code>tick()</cb-code> wird, wie oben bereits beschrieben, in jedem Spieltick ausgeführt, also 20 mal pro Sekunde. Das heißt also, dass die Lampe alle 20 Ticks ihren Zustand ändern soll.
</p>
<p>
  Das Programm muss also wissen, wie viele Ticks seit Programmstart vergangen sind. Dazu brauchen wir eine Variable.
</p>

<div class="cb-text-box large">
  <cb-badge badge="java"></cb-badge>
  <p>
    <b>Variablen</b> findet man in fast allen Programmiersprachen. Der Computer verwendet sie, um sich Dinge zu marken. Eine Variable hat einen Namen, einen Wert und einen Typ, also die Information, welche Art von Werten sie speichern kann. In Java legt man eine Variable an mit <cb-code>&lt;Typ&gt; &lt;Name&gt; = &lt;Startwert&gt;</cb-code>. Möchte man einer Variable einen neuen Wert zuweisen, lautet der Befehl <cb-code>&lt;Name&gt; = &lt;neuer Wert&gt;</cb-code>. Der Typ einer Variable kann z. B. <cb-code>int</cb-code> sein, also eine Ganzzahl, oder <cb-code>String</cb-code> für Text. Möchte man den Wert einer Variable verwenden, schreibt man einfach den Namen.
  </p>
  <p>
    Im folgenden Beispiel wird eine ganzzahlige Variable mit dem Namen <cb-code>a</cb-code> und dem Startwert 38 erstellt. Anschließend wird der Wert um 4 erhöht, indem der Wert auf die Summe aus dem bisherigen Wert und 4 gesetzt wird.
  </p>
  <cb-code src="assets/documents/lehrbogen/listing-variablen.java"></cb-code>
</div>

<p>
  Lege also eine Variable <cb-code>ticks</cb-code> an, die als Wert immer die aktuelle Anzahl von Ticks enthalten soll, die nach Programmstart vergangen sind. Da die Variable nicht immer wieder neu angelegt werden soll, sondern während dem ganzen Programmverlauf bestehen, musst du sie außerhalb von <cb-code>tick()</cb-code> anlegen.
</p>
<p>
  Sie soll jetzt bei jedem Aufruf von <cb-code>tick()</cb-code> um 1 hochgezählt werden. Das kannst du lösen, indem du innerhalb von <cb-code>tick()</cb-code> den aktuellen Wert von <cb-code>ticks</cb-code> mit 1 addierst und das Ergebnis als neuen Wert von <cb-code>ticks</cb-code> speicherst. Dieser Teil des Programms sieht jetzt also so aus:
</p>
<cb-code src="assets/documents/lehrbogen/listing-ticks.java"></cb-code>

<h2>Lampensteuerung</h2>

<p>
  Als nächstes muss das Programm auf Grundlage der aktuell vergangenen Spielticks entscheiden können, was es tun muss. Sieh dir dazu dieses Schaubild an:
</p>
<img src="assets/documents/lehrbogen/abb-versuch2-ablauf.png">
<p>
  Wie du siehst, wiederholt sich die Abfolge nach 20 Ticks. Bei Tick 0 soll die Lampe angeschaltet werden, bei Tick 10 soll sie ausgeschaltet werden. Bei Tick 20 soll sie wieder angeschaltet werden, entsprechend bei 30 wieder aus.
</p>
<p>
  Wir können also erkennen, dass die Lampe geschaltet werden soll, wenn <i>die Division der aktuellen Tickzahl durch 20 den Rest 0 bzw. 10 ergibt</i>.
</p>
<p>
  Beispiele:
  <br>0 &divide; 20 = 0 Rest <b>0</b> => an
  <br>10 &divide; 20 = 0 Rest <b>10</b> => aus
  <br>20 &divide; 20 = 1 Rest <b>0</b> => an
  <br>30 &divide; 20 = 1 Rest <b>10</b> => aus
</p>
<p>
  In Java drückt man das mit einer Modulo-Operation aus: <cb-code>a % b</cb-code> ergibt den Rest der Division <cb-code>a</cb-code> &divide; <cb-code>b</cb-code>.
</p>
<p>
  Wir können also folgenden Programmablauf festlegen:
</p>
<img src="assets/documents/lehrbogen/abb-versuch2-algorithmus.png" class="extra-small-regular">
<p>
  Du siehst bereits, dass wir hierfür eine konditionale Verzweigung brauchen. Nur falls eine Bedingung eintritt, soll ein Befehl ausgeführt werden.
</p>

<div class="cb-text-box large">
  <cb-badge badge="java"></cb-badge>
  <p>
    <b>Verzweigungen</b> findet man auch in den meisten Programmiersprachen, und sie sind eine der grundlegendsten Werkzeuge, um den Programmablauf zu bestimmen. Die einfachste Form der Verzweigung ist eine <cb-code>if</cb-code>-Verzweigung der Form <cb-code>if (&lt;Bedingung&gt;) {{"{"}} &lt;Befehle&gt; }</cb-code>. Sie bedeutet, dass die Befehle innerhalb der geschweiften Klammern (<cb-code>{{"{"}}</cb-code>, <cb-code>}</cb-code>) nur ausgeführt werden, wenn die Bedingung zutrifft.
  </p>
  <p>
    Die Bedingung kann z. B. ein Vergleich zwischen zwei Zahlen sein, wie etwa <cb-code>&lt;</cb-code>, <cb-code>&gt;</cb-code> oder <cb-code>==</cb-code>. Wie du siehst, wird Gleichheit durch zwei <cb-code>=</cb-code> ausgedrückt, um es von einer Wertzuweisung einer Variable zu unterscheiden.
    <br><span class="cb-warn">!</span> Achtung: In der hier verwendeten Schriftart sieht <cb-code>==</cb-code> aus wie ein besonders langes Gleichheitszeichen, es sind aber zwei! Beachte das auch bei den folgenden Codebeispielen.
  </p>
</div>

<p>
  Zuletzt kannst du jetzt alle Bruchstücke zu einem fertigen Programm verbinden:
</p>
<cb-code src="assets/documents/lehrbogen/listing-versuch2-final.java"></cb-code>

<p>
  <b>Herzlichen Glückwunsch!</b> Du kannst den Cranberri-Computer jetzt neu starten, um das neue Programm zu testen. Die Lampe sollte wie erwartet in Intervallen von einer halben Sekunde blinken.
</p>

<div class="cb-text-box black">
  <h2>Übungsaufgabe</h2>
  <p>
    Schreibe ein Programm, das die Lampe fortwährend für 1s anschaltet und dann für 2s ausschaltet.
  </p>
  <cb-collapsable label="Lösung">
    <p>
      Entsprechend der Aufgabenstellung ist die Dauer der Wiederholung insgesamt 3s, also 60 Ticks. Die Lampe muss also bei 0 Ticks an- und bei 20 Ticks ausgeschaltet werden. Das Programm ist dasselbe wie bisher, nur mit veränderten Zahlenwerten:
    </p>
    <cb-code src="assets/documents/lehrbogen/listing-versuch2-aufgabe-loesung.java"></cb-code>
  </cb-collapsable>
</div>


<cb-chapter ordinal="->">Weiterführend</cb-chapter>

<p>
  An dieser Stelle ist dieser Lehrbogen vorerst zu Ende.
  Weitere Cranberri-Materialien findest du <a routerLink="/">hier</a>.
  Weitere Informationen zu Cranberri findest du <a href="https://github.com/JupiterPi/cranberri">auf der GitHub-Seite</a>.
</p>
<p>
  Vielen Dank für dein Interesse!
</p>
